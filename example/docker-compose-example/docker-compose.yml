version: "3.8"
services:
  spring:
    build:
      context: ../
      dockerfile: docker-compose-example/spring.Dockerfile
    ports:
      - "8080:8080"
    environment:
      - pdp.policy.path=/authz/allow
      - pdp.hostname=pdp
    networks:
      - dev

  pdp:
    image: buildsecurity/pdp
    networks:
      - dev
    ports:
      - "8181:8181"
    environment:
      - API_KEY=R5Irjd6oSa966bAqxtUU9xrZ6ivxYGhT
      - API_SECRET=fnVZJCTjxbzELoi3FnsmSSIJn6S7XHLm5kuEXgxynuhnT2ubKVfiv4l5OEQCEkkJ
      - CONTROL_PLANE_ADDR=https://console.poc.build.security/v1/api/pdp
      - PG_PASSWD=password
networks:
  dev:

